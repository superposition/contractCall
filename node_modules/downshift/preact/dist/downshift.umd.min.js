!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("preact")):"function"==typeof define&&define.amd?define(["preact"],t):e.Downshift=t(e.preact)}(this,function(e){"use strict";var n="default"in e?e.default:e,o="undefined"==typeof document?null:document.getElementById("a11y-status-message"),s=[];function u(e){var t=s[s.length-1]===e;s=t?[].concat(s,[e]):[e];for(var r=function(){if(o)return o;return(o=document.createElement("div")).setAttribute("id","a11y-status-message"),o.setAttribute("role","status"),o.setAttribute("aria-live","assertive"),o.setAttribute("aria-relevant","additions text"),Object.assign(o.style,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px"}),document.body.appendChild(o),o}();r.lastChild;)r.removeChild(r.firstChild);s.filter(Boolean).forEach(function(e,t){var n,o,i;r.appendChild((n=e,o=t===s.length-1?"block":"none",(i=document.createElement("div")).style.display=o,i.textContent=n,i))})}var l=0;function t(e){return"function"==typeof e?e:i}function i(){}var a=function e(t,n,o){return null!==n&&n!==o.parentNode?t(n)?n===document.body&&0===n.scrollTop?document.documentElement:n:e(t,n.parentNode,o):null}.bind(null,function(e){return e.scrollHeight>e.clientHeight});function c(){for(var e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t];return function(t){for(var e=arguments.length,n=Array(1<e?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return i.some(function(e){return e&&e.apply(void 0,[t].concat(n)),t.preventDownshiftDefault||t.defaultPrevented})}}function g(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.find(function(e){return void 0!==e})}function p(e,t){return!(e=Array.isArray(e)?e[0]:e)&&t?t:e}function d(e){return e.nodeName?"string"==typeof e.nodeName:"string"==typeof e.type}function h(e){return e.props||e.attributes}var r=["highlightedIndex","inputValue","isOpen","selectedItem","type"];function f(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n={};return r.forEach(function(e){t.hasOwnProperty(e)&&(n[e]=t[e])}),n}var m=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I=function(e,t){var n={};for(var o in e)0<=t.indexOf(o)||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},v=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},_=function(r){function a(){m(this,a);for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=v(this,r.call.apply(r,[this].concat(t)));w.call(o);var i=o.getState({highlightedIndex:o.props.defaultHighlightedIndex,isOpen:o.props.defaultIsOpen,inputValue:o.props.defaultInputValue,selectedItem:o.props.defaultSelectedItem});return i.selectedItem&&(i.inputValue=o.props.itemToString(i.selectedItem)),o.state=i,o.id=o.props.id||"downshift-"+String(l++),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,r),a.prototype.getState=function(){var n=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state;return Object.keys(o).reduce(function(e,t){return e[t]=n.isControlledProp(t)?n.props[t]:o[t],e},{})},a.prototype.isControlledProp=function(e){return void 0!==this.props[e]},a.prototype.getItemCount=function(){return null!=this.itemCount?this.itemCount:void 0!==this.props.itemCount?this.props.itemCount:this.items.length},a.prototype.internalSetState=function(i,e){var r=this,s=void 0,u=void 0,l={},p="function"==typeof i;return!p&&i.hasOwnProperty("inputValue")&&this.props.onInputValueChange(i.inputValue,y({},this.getStateAndHelpers(),i)),this.setState(function(t){t=r.getState(t),i=p?i(t):i,i=r.props.stateReducer(t,i),s=i.hasOwnProperty("selectedItem");var n={},o={};return s&&i.selectedItem!==t.selectedItem&&(u=i.selectedItem),i.type=i.type||a.stateChangeTypes.unknown,Object.keys(i).forEach(function(e){t[e]!==i[e]&&(l[e]=i[e]),"type"!==e&&(o[e]=i[e],r.isControlledProp(e)||(n[e]=i[e]))}),p&&i.hasOwnProperty("inputValue")&&r.props.onInputValueChange(i.inputValue,y({},r.getStateAndHelpers(),i)),n},function(){t(e)(),1<Object.keys(l).length&&r.props.onStateChange(l,r.getStateAndHelpers()),s&&r.props.onSelect(i.selectedItem,r.getStateAndHelpers()),void 0!==u&&r.props.onChange(u,r.getStateAndHelpers()),r.props.onUserAction(l,r.getStateAndHelpers())})},a.prototype.getStateAndHelpers=function(){var e=this.getState(),t=e.highlightedIndex,n=e.inputValue,o=e.selectedItem,i=e.isOpen,r=this.props.itemToString,s=this.id,u=this.getRootProps,l=this.getButtonProps,p=this.getLabelProps,a=this.getInputProps,d=this.getItemProps,h=this.openMenu,c=this.closeMenu,g=this.toggleMenu,f=this.selectItem,m=this.selectItemAtIndex,y=this.selectHighlightedItem,I=this.setHighlightedIndex,v=this.clearSelection,_=this.clearItems;return{getRootProps:u,getButtonProps:l,getLabelProps:p,getInputProps:a,getItemProps:d,reset:this.reset,openMenu:h,closeMenu:c,toggleMenu:g,selectItem:f,selectItemAtIndex:m,selectHighlightedItem:y,setHighlightedIndex:I,clearSelection:v,clearItems:_,setItemCount:this.setItemCount,unsetItemCount:this.unsetItemCount,itemToString:r,id:s,highlightedIndex:t,inputValue:n,isOpen:i,selectedItem:o}},a.prototype.getItemId=function(e){return this.id+"-item-"+e},a.prototype.componentDidMount=function(){var n=this;this._isMounted=!0;var e=function(){n.isMouseDown=!0},t=function(e){var t=n.props.environment.document;n.isMouseDown=!1,e.target!==n._rootNode&&n._rootNode.contains(e.target)||!n.getState().isOpen||n.inputId&&t.activeElement.id===n.inputId||n.reset({type:a.stateChangeTypes.mouseUp},function(){return n.props.onOuterClick(n.getStateAndHelpers())})};this.props.environment.addEventListener("mousedown",e),this.props.environment.addEventListener("mouseup",t),this.cleanup=function(){n._isMounted=!1,n.props.environment.removeEventListener("mousedown",e),n.props.environment.removeEventListener("mouseup",t)}},a.prototype.componentDidUpdate=function(e,t){this.isControlledProp("selectedItem")&&this.props.selectedItemChanged(e.selectedItem,this.props.selectedItem)&&this.internalSetState({type:a.stateChangeTypes.controlledPropUpdatedSelectedItem,inputValue:this.props.itemToString(this.props.selectedItem)});var n=void 0===this.props.highlightedIndex?this.state:this.props,o=void 0===e.highlightedIndex?t:e;n.highlightedIndex===o.highlightedIndex||this.avoidScrolling||this.scrollHighlightedItemIntoView(),this.updateStatus()},a.prototype.componentWillUnmount=function(){this.cleanup()},a.prototype.render=function(){var e=p(this.props.render||this.props.children,i);this.clearItems(),this.getRootProps.called=!1,this.getRootProps.refKey=void 0,this.getRootProps.suppressRefError=void 0,this.getLabelProps.called=!1,this.getInputProps.called=!1;var t=p(e(this.getStateAndHelpers()));if(!t)return null;if(this.getRootProps.called)return this.getRootProps.suppressRefError||function(e,t){var n=t.refKey,o="ref"!==n,i=!d(e);{if(i&&!o)throw new Error("downshift: You returned a non-DOM element. You must specify a refKey in getRootProps");if(!i&&o)throw new Error('downshift: You returned a DOM element. You should not specify a refKey in getRootProps. You specified "'+n+'"')}if(!h(e)[n])throw new Error('downshift: You must apply the ref prop "'+n+'" from getRootProps onto your root element.')}(t,this.getRootProps),t;if(d(t))return n.cloneElement(t,this.getRootProps(h(t)));throw new Error("downshift: If you return a non-DOM element, you must use apply the getRootProps function")},a}(e.Component);_.defaultProps={defaultHighlightedIndex:null,defaultSelectedItem:null,defaultInputValue:"",defaultIsOpen:!1,getA11yStatusMessage:function(e){var t=e.isOpen,n=e.highlightedItem,o=e.selectedItem,i=e.resultCount,r=e.previousResultCount,s=e.itemToString;return t?i?n&&i===r?s(n):i+" "+(1===i?"result is":"results are")+" available, use up and down arrow keys to navigate.":"No results.":o?s(o):""},itemToString:function(e){return null==e?"":String(e)},onStateChange:function(){},onInputValueChange:function(){},onUserAction:function(){},onChange:function(){},onSelect:function(){},onOuterClick:function(){},selectedItemChanged:function(e,t){return e!==t},environment:"undefined"==typeof window?{}:window,stateReducer:function(e,t){return t},breakingChanges:{}},_.stateChangeTypes={unknown:"__autocomplete_unknown__",mouseUp:"__autocomplete_mouseup__",itemMouseEnter:"__autocomplete_item_mouseenter__",keyDownArrowUp:"__autocomplete_keydown_arrow_up__",keyDownArrowDown:"__autocomplete_keydown_arrow_down__",keyDownEscape:"__autocomplete_keydown_escape__",keyDownEnter:"__autocomplete_keydown_enter__",clickItem:"__autocomplete_click_item__",blurInput:"__autocomplete_blur_input__",changeInput:"__autocomplete_change_input__",keyDownSpaceButton:"__autocomplete_keydown_space_button__",clickButton:"__autocomplete_click_button__",blurButton:"__autocomplete_blur_button__",controlledPropUpdatedSelectedItem:"__autocomplete_controlled_prop_updated_selected_item__"};var w=function(){var o,i,r,h=this;this.input=null,this.items=[],this.itemCount=null,this.previousResultCount=0,this.setItemCount=function(e){return h.itemCount=e},this.unsetItemCount=function(){return h.itemCount=null},this.getItemNodeFromIndex=function(e){return h.props.environment.document.getElementById(h.getItemId(e))},this.setHighlightedIndex=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:h.props.defaultHighlightedIndex,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t=f(t),h.internalSetState(y({highlightedIndex:e},t))},this.scrollHighlightedItemIntoView=function(){!function(e,t){var n=a(e,t);if(null!==n){var o=getComputedStyle(n),i=n.getBoundingClientRect(),r=parseInt(o.borderTopWidth,10),s=r+parseInt(o.borderBottomWidth,10),u=i.top+r,l=e.getBoundingClientRect();if(l.top<0&&i.top<0)n.scrollTop+=l.top;else if(l.top<0)n.scrollTop+=l.top-u;else if(0<l.top&&i.top<0)0<i.bottom&&l.bottom+s>i.bottom&&(n.scrollTop+=l.bottom-i.bottom+s);else{var p=l.top+n.scrollTop-u;p<n.scrollTop?n.scrollTop=p:p+l.height+s>n.scrollTop+i.height&&(n.scrollTop=p+l.height-i.height+s)}}}(h.getItemNodeFromIndex(h.getState().highlightedIndex),h._rootNode)},this.openAndHighlightDefaultIndex=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};h.setHighlightedIndex(void 0,y({isOpen:!0},e))},this.highlightDefaultIndex=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};h.setHighlightedIndex(void 0,e)},this.moveHighlightedIndex=function(e,t){h.getState().isOpen?h.changeHighlightedIndex(e,t):h.openAndHighlightDefaultIndex(t)},this.changeHighlightedIndex=function(e,t){var n=h.getItemCount()-1;if(!(n<0)){var o=h.getState().highlightedIndex;null===o&&(o=0<e?-1:n+1);var i=o+e;i<0?i=n:n<i&&(i=0),h.setHighlightedIndex(i,t)}},this.clearSelection=function(e){h.internalSetState({selectedItem:null,inputValue:"",isOpen:!1},e)},this.selectItem=function(e,t,n){t=f(t),h.internalSetState(y({isOpen:!1,highlightedIndex:h.props.defaultHighlightedIndex,selectedItem:e,inputValue:h.isControlledProp("selectedItem")&&h.props.breakingChanges.resetInputOnSelection?h.props.defaultInputValue:h.props.itemToString(e)},t),n)},this.selectItemAtIndex=function(e,t,n){var o=h.items[e];null!=o&&h.selectItem(o,t,n)},this.selectHighlightedItem=function(e,t){return h.selectItemAtIndex(h.getState().highlightedIndex,e,t)},this.rootRef=function(e){return h._rootNode=e},this.getRootProps=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).suppressRefError,o=void 0!==n&&n,i=t.refKey,r=void 0===i?"ref":i,s=I(t,["refKey"]);return h.getRootProps.called=!0,h.getRootProps.refKey=r,h.getRootProps.suppressRefError=o,y(((e={})[r]=h.rootRef,e),s)},this.keyDownHandlers={ArrowDown:function(e){e.preventDefault();var t=e.shiftKey?5:1;this.moveHighlightedIndex(t,{type:_.stateChangeTypes.keyDownArrowDown})},ArrowUp:function(e){e.preventDefault();var t=e.shiftKey?-5:-1;this.moveHighlightedIndex(t,{type:_.stateChangeTypes.keyDownArrowUp})},Enter:function(e){this.getState().isOpen&&(e.preventDefault(),this.selectHighlightedItem({type:_.stateChangeTypes.keyDownEnter}))},Escape:function(e){e.preventDefault(),this.reset({type:_.stateChangeTypes.keyDownEscape})}},this.buttonKeyDownHandlers=y({},this.keyDownHandlers,{" ":function(e){e.preventDefault(),this.toggleMenu({type:_.stateChangeTypes.keyDownSpaceButton})}}),this.getButtonProps=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.onClick,n=e.onKeyDown,o=e.onBlur,i=I(e,["onClick","onKeyDown","onBlur"]),r=h.getState().isOpen,s={onClick:c(t,h.button_handleClick),onKeyDown:c(n,h.button_handleKeyDown),onBlur:c(o,h.button_handleBlur)},u=i.disabled?{}:s;return y({type:"button",role:"button","aria-label":r?"close menu":"open menu","aria-expanded":r,"aria-haspopup":!0},u,i)},this.button_handleKeyDown=function(e){h.buttonKeyDownHandlers[e.key]&&h.buttonKeyDownHandlers[e.key].call(h,e)},this.button_handleClick=function(e){e.preventDefault(),h.props.environment.document.activeElement===h.props.environment.document.body&&e.target.focus(),h.toggleMenu({type:_.stateChangeTypes.clickButton})},this.button_handleBlur=function(){h.isMouseDown||h.reset({type:_.stateChangeTypes.blurButton})},this.getLabelProps=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(h.getLabelProps.called=!0,h.getInputProps.called&&e.htmlFor&&e.htmlFor!==h.inputId)throw new Error('downshift: You provided the htmlFor of "'+e.htmlFor+'" for your label, but the id of your input is "'+h.inputId+'". You must either remove the id from your input or set the htmlFor of the label equal to the input id.');return h.inputId=g(h.inputId,e.htmlFor,h.id+"-input"),y({},e,{htmlFor:h.inputId})},this.getInputProps=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.onKeyDown,o=t.onBlur,i=t.onChange,r=t.onInput,s=I(t,["onKeyDown","onBlur","onChange","onInput"]);if(h.getInputProps.called=!0,h.getLabelProps.called&&s.id&&s.id!==h.inputId)throw new Error('downshift: You provided the id of "'+s.id+'" for your input, but the htmlFor of your label is "'+h.inputId+'". You must either remove the id from your input or set the htmlFor of the label equal to the input id.');h.inputId=g(h.inputId,s.id,h.id+"-input");var u=h.getState(),l=u.inputValue,p=u.isOpen,a=u.highlightedIndex,d=s.disabled?{}:((e={}).onInput=c(i,r,h.input_handleChange),e.onKeyDown=c(n,h.input_handleKeyDown),e.onBlur=c(o,h.input_handleBlur),e);return y({role:"combobox","aria-autocomplete":"list","aria-expanded":p,"aria-activedescendant":p&&"number"==typeof a&&0<=a?h.getItemId(a):null,autoComplete:"off",value:l},d,s,{id:h.inputId})},this.input_handleKeyDown=function(e){e.key&&h.keyDownHandlers[e.key]&&h.keyDownHandlers[e.key].call(h,e)},this.input_handleChange=function(e){h.internalSetState({type:_.stateChangeTypes.changeInput,isOpen:!0,inputValue:e.target.value})},this.input_handleBlur=function(){h.isMouseDown||h.reset({type:_.stateChangeTypes.blurInput})},this.getItemProps=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.onMouseMove,o=t.onMouseDown,i=t.onClick,r=t.index,s=t.item,u=void 0===s?function(e,t){throw new Error('The property "'+t+'" is required in "'+e+'"')}("getItemProps","item"):s,l=I(t,["onMouseMove","onMouseDown","onClick","index","item"]);void 0===r?(h.items.push(u),r=h.items.indexOf(u)):h.items[r]=u;return y(((e={id:h.getItemId(r),onMouseMove:c(n,function(){r!==h.getState().highlightedIndex&&(h.setHighlightedIndex(r,{type:_.stateChangeTypes.itemMouseEnter}),h.avoidScrolling=!0,setTimeout(function(){return h.avoidScrolling=!1},250))}),onMouseDown:c(o,function(e){e.preventDefault()})}).onClick=c(i,function(){h.selectItemAtIndex(r,{type:_.stateChangeTypes.clickItem})}),e),l)},this.clearItems=function(){h.items=[]},this.reset=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];n=f(n),h.internalSetState(function(e){var t=e.selectedItem;return y({isOpen:!1,highlightedIndex:h.props.defaultHighlightedIndex,inputValue:h.props.itemToString(t)},n)},t(e))},this.toggleMenu=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];n=f(n),h.internalSetState(function(e){var t=e.isOpen;return y({isOpen:!t},n)},function(){h.getState().isOpen&&h.highlightDefaultIndex(),t(e)()})},this.openMenu=function(e){h.internalSetState({isOpen:!0},t(e))},this.closeMenu=function(e){h.internalSetState({isOpen:!1},t(e))},this.updateStatus=(o=function(){if(h._isMounted){var e=h.getState(),t=h.items[e.highlightedIndex],n=h.getItemCount(),o=h.props.getA11yStatusMessage(y({itemToString:h.props.itemToString,previousResultCount:h.previousResultCount,resultCount:n,highlightedItem:t},e));h.previousResultCount=n,u(o)}},i=200,r=void 0,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];r&&clearTimeout(r),r=setTimeout(function(){r=null,o.apply(void 0,t)},i)})};return(_.default=_).resetIdCounter=function(){l=0},_});
//# sourceMappingURL=downshift.umd.min.js.map
